<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard DOM Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-result { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background-color: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
        .error { background-color: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; }
        .cards-container { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 15px; 
            margin: 20px 0; 
        }
        .card { 
            padding: 20px; 
            background: white; 
            border-radius: 8px; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); 
            text-align: center;
        }
        .card-icon { 
            width: 50px; 
            height: 50px; 
            margin: 0 auto 10px; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 20px;
        }
        button { 
            padding: 10px 20px; 
            margin: 10px 5px; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer; 
        }
        .btn-primary { background-color: #007bff; color: white; }
        .btn-success { background-color: #28a745; color: white; }
        .btn-danger { background-color: #dc3545; color: white; }
    </style>
</head>
<body>
    <h1>üîß Dashboard DOM Element Test</h1>
    <p>This page tests if the dashboard DOM element detection and creation works properly.</p>

    <div class="test-result" id="dom-test-result">
        <strong>DOM Test:</strong> <span id="dom-status">Running...</span>
    </div>

    <div class="test-result" id="creation-test-result">
        <strong>Creation Test:</strong> <span id="creation-status">Waiting...</span>
    </div>

    <button class="btn-primary" onclick="testDOMElements()">Test DOM Elements</button>
    <button class="btn-success" onclick="testCardCreation()">Test Card Creation</button>
    <button class="btn-danger" onclick="testDebugFunction()">Test Debug Function</button>

    <!-- This will be created dynamically if missing -->
    <main>
        <div class="cards-container">
            <!-- Cards will be added here -->
        </div>
    </main>

    <script src="config.js"></script>
    <script>
        function testDOMElements() {
            const filterBulan = document.getElementById('filter-bulan');
            const filterTahun = document.getElementById('filter-tahun');
            const cardsContainer = document.querySelector('.cards-container');
            
            const results = {
                filterBulan: !!filterBulan,
                filterTahun: !!filterTahun,
                cardsContainer: !!cardsContainer
            };
            
            const resultDiv = document.getElementById('dom-test-result');
            const statusSpan = document.getElementById('dom-status');
            
            if (results.cardsContainer) {
                resultDiv.className = 'test-result success';
                statusSpan.textContent = '‚úÖ Cards container found!';
            } else {
                resultDiv.className = 'test-result error';
                statusSpan.textContent = '‚ùå Cards container missing!';
            }
            
            console.log('DOM Elements:', results);
        }

        function testCardCreation() {
            let cardsContainer = document.querySelector('.cards-container');
            
            if (!cardsContainer) {
                const main = document.querySelector('main');
                if (main) {
                    cardsContainer = document.createElement('div');
                    cardsContainer.className = 'cards-container';
                    main.appendChild(cardsContainer);
                }
            }
            
            if (cardsContainer) {
                cardsContainer.innerHTML = '';
                
                const testCard = document.createElement('div');
                testCard.className = 'card';
                testCard.innerHTML = `
                    <div class="card-icon" style="background-color: #007bff20; color: #007bff;">
                        <i>üìä</i>
                    </div>
                    <h3>Test Card</h3>
                    <div class="card-value">SUCCESS</div>
                `;
                cardsContainer.appendChild(testCard);
                
                const resultDiv = document.getElementById('creation-test-result');
                const statusSpan = document.getElementById('creation-status');
                resultDiv.className = 'test-result success';
                statusSpan.textContent = '‚úÖ Card created successfully!';
            } else {
                const resultDiv = document.getElementById('creation-test-result');
                const statusSpan = document.getElementById('creation-status');
                resultDiv.className = 'test-result error';
                statusSpan.textContent = '‚ùå Failed to create cards container!';
            }
        }

        function testDebugFunction() {
            // Test the debug function without loading the full dashboard.js
            console.log('üîß Testing debug function simulation...');
            let cardsContainer = document.querySelector('.cards-container');
            
            if (!cardsContainer) {
                const main = document.querySelector('main');
                if (main) {
                    cardsContainer = document.createElement('div');
                    cardsContainer.className = 'cards-container';
                    main.appendChild(cardsContainer);
                }
            }
            
            if (cardsContainer) {
                cardsContainer.innerHTML = '';
                
                const testStats = {
                    totalCustomers: 65,
                    activeCustomers: 51,
                    totalRevenue: 234470000,
                    totalExpenses: 73094192
                };
                
                const formatter = new Intl.NumberFormat('id-ID', {
                    style: 'currency',
                    currency: 'IDR',
                    minimumFractionDigits: 0
                });
                
                const statsCards = [
                    { icon: 'üí∞', label: 'Total Pendapatan', value: formatter.format(testStats.totalRevenue), color: '#20b2aa' },
                    { icon: 'üí∏', label: 'Total Pengeluaran', value: formatter.format(testStats.totalExpenses), color: '#ff6347' },
                    { icon: 'üë•', label: 'Total Pelanggan', value: testStats.totalCustomers, color: '#6a5acd' },
                    { icon: '‚úÖ', label: 'Pelanggan Aktif', value: testStats.activeCustomers, color: '#32cd32' }
                ];
                
                statsCards.forEach(card => {
                    const cardElement = document.createElement('div');
                    cardElement.className = 'card';
                    cardElement.innerHTML = `
                        <div class="card-icon" style="background-color: ${card.color}20; color: ${card.color};">
                            ${card.icon}
                        </div>
                        <h3>${card.label}</h3>
                        <div class="card-value">${card.value}</div>
                    `;
                    cardsContainer.appendChild(cardElement);
                });
                
                alert('‚úÖ Debug test completed! Check the cards below.');
            } else {
                alert('‚ùå Could not create cards container for debug test.');
            }
        }

        // Auto-run DOM test on page load
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(testDOMElements, 500);
        });
    </script>
</body>
</html>