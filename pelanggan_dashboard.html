<!DOCTYPE html>
<html class="light" lang="id">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Dashboard Pelanggan - Selinggonet</title>

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#135bec">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Selinggonet">
    <meta name="description" content="Dashboard pelanggan sistem manajemen ISP">

    <!-- PWA Icons -->
    <link rel="icon" type="image/png" sizes="512x512" href="assets/logo_512x512.png">
    <link rel="apple-touch-icon" sizes="192x192" href="assets/logo_192x192.png">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/fonts.css">

    <style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        .material-symbols-outlined.fill {
            font-variation-settings: 'FILL' 1;
        }

        body {
            min-height: max(884px, 100dvh);
        }
    </style>
</head>

<body class="font-display" style="overflow-x: hidden;">
    <div id="loading-overlay"
        class="fixed inset-0 bg-background-light dark:bg-background-dark z-50 flex items-center justify-center">
        <div class="animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-primary"></div>
    </div>

    <div
        class="relative flex h-auto min-h-screen w-full flex-col bg-background-light dark:bg-background-dark group/design-root">

        <header
            class="flex items-center p-4 pb-2 justify-between sticky top-0 z-30 bg-background-light dark:bg-background-dark shadow-sm">
            <div class="flex items-center gap-3">
                <div id="user-avatar" class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10"></div>
                <h1 id="welcome-text" class="text-slate-900 dark:text-white text-lg font-bold">Halo, ...</h1>
            </div>
            <button id="logout-btn"
                class="flex items-center justify-center rounded-full h-12 w-12 text-slate-900 dark:text-white hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
                <span class="material-symbols-outlined text-2xl">logout</span>
            </button>
        </header>

        <main class="flex-1 flex flex-col gap-4 p-4 pb-20">
            <!-- Tagihan Section -->
            <div id="tagihan-card"
                class="flex flex-col items-stretch justify-start rounded-xl shadow-[0_4px_12px_rgba(0,0,0,0.05)] bg-white dark:bg-slate-800 p-5">
                <!-- Content will be dynamically inserted by JS -->
            </div>

            <!-- Paket Aktif Section -->
            <div id="paket-aktif-card"
                class="flex flex-col items-stretch justify-start rounded-xl shadow-[0_4px_12px_rgba(0,0,0,0.05)] bg-white dark:bg-slate-800 p-5">
                <!-- Content will be dynamically inserted by JS -->
            </div>

            <!-- Riwayat Pembayaran Section -->
            <div class="flex flex-col items-stretch gap-3">
                <div class="flex items-center justify-between">
                    <h2 class="text-slate-900 dark:text-white text-base font-bold">Riwayat Pembayaran</h2>
                    <a href="pelanggan_riwayat_lunas.html" class="text-primary text-sm font-bold">Lihat Semua</a>
                </div>
                <div id="riwayat-pembayaran-list"
                    class="flex flex-col rounded-xl overflow-hidden shadow-[0_4px_12px_rgba(0,0,0,0.05)] bg-white dark:bg-slate-800">
                    <!-- History items will be dynamically inserted by JS -->
                </div>
            </div>
        </main>

        <footer class="fixed bottom-0 left-0 right-0 z-50 bg-[#f9f8fc] border-t border-[#eae7f3]">
            <div class="flex gap-2 px-4 pb-3 pt-2">
                <a class="flex flex-1 flex-col items-center justify-end gap-1 text-primary"
                    href="pelanggan_dashboard.html">
                    <div class="text-primary flex h-8 items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor"
                            viewBox="0 0 256 256">
                            <path
                                d="M224,115.55V208a16,16,0,0,1-16,16H168a16,16,0,0,1-16-16V168a8,8,0,0,0-8-8H112a8,8,0,0,0-8,8v40a16,16,0,0,1-16,16H48a16,16,0,0,1-16-16V115.55a16,16,0,0,1,5.17-11.78l80-75.48.11-.11a16,16,0,0,1,21.53,0,1.14,1.14,0,0,0,.11.11l80,75.48A16,16,0,0,1,224,115.55Z">
                            </path>
                        </svg>
                    </div>
                    <p class="text-primary text-xs font-medium leading-normal tracking-[0.015em]">Home</p>
                </a>
                <a class="flex flex-1 flex-col items-center justify-end gap-1 text-slate-400 dark:text-slate-500"
                    href="pelanggan_riwayat_lunas.html">
                    <div class="text-slate-400 dark:text-slate-500 flex h-8 items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor"
                            viewBox="0 0 256 256">
                            <path
                                d="M224,128A96,96,0,0,1,62.11,197.82a8,8,0,1,1,11-11.64A80,80,0,1,0,71.43,71.43C67.9,75,64.58,78.51,61.35,82L77.66,98.34A8,8,0,0,1,72,112H32a8,8,0,0,1-8-8V64a8,8,0,0,1,13.66-5.66L50,70.7c3.22-3.49,6.54-7,10.06-10.55A96,96,0,0,1,224,128ZM128,72a8,8,0,0,0-8,8v48a8,8,0,0,0,3.88,6.86l40,24a8,8,0,1,0,8.24-13.72L136,123.47V80A8,8,0,0,0,128,72Z">
                            </path>
                        </svg>
                    </div>
                    <p class="text-slate-400 dark:text-slate-500 text-xs font-medium leading-normal tracking-[0.015em]">
                        Riwayat</p>
                </a>
                <a class="flex flex-1 flex-col items-center justify-end gap-1 text-slate-400 dark:text-slate-500"
                    href="menu_bantuan.html">
                    <div class="text-slate-400 dark:text-slate-500 flex h-8 items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor"
                            viewBox="0 0 256 256">
                            <path
                                d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Z">
                            </path>
                            <path
                                d="M128,72c-22.1,0-40,17.9-40,40a8,8,0,0,0,16,0c0-13.2,10.8-24,24-24s24,10.8,24,24c0,13.2-10.8,24-24,24a8,8,0,0,0-8,8v8a8,8,0,0,0,16,0v-1.1c19.6-4.3,32-21.7,32-40.9C168,89.9,150.1,72,128,72Z">
                            </path>
                            <circle cx="128" cy="180" r="12"></circle>
                        </svg>
                    </div>
                    <p class="text-slate-400 dark:text-slate-500 text-xs font-medium leading-normal tracking-[0.015em]">
                        Bantuan</p>
                </a>
                <a class="flex flex-1 flex-col items-center justify-end gap-1 text-slate-400 dark:text-slate-500"
                    href="pelanggan_profile.html">
                    <div class="text-slate-400 dark:text-slate-500 flex h-8 items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor"
                            viewBox="0 0 256 256">
                            <path
                                d="M230.92,212c-15.23-26.33-38.7-45.21-66.09-54.16a72,72,0,1,0-73.66,0C63.78,166.78,40.31,185.66,25.08,212a8,8,0,1,0,13.85,8c18.84-32.56,52.14-52,89.07-52s70.23,19.44,89.07,52a8,8,0,1,0,13.85-8ZM72,96a56,56,0,1,1,56,56A56.06,56.06,0,0,1,72,96Z">
                            </path>
                        </svg>
                    </div>
                    <p class="text-slate-400 dark:text-slate-500 text-xs font-medium leading-normal tracking-[0.015em]">
                        Akun</p>
                </a>
            </div>
        </footer>
    </div>

    <script type="module" src="supabase-client.js"></script>
    <script type="module" src="auth.js"></script>
    <script type="module" src="apply-settings.js"></script>
    <script type="module" src="pelanggan_dashboard.js"></script>

    <!-- Payment Modal -->
    <div id="toast"
        class="fixed top-5 right-5 bg-green-500 text-white py-2 px-4 rounded-lg shadow-lg opacity-0 invisible transition-all duration-300 ease-in-out z-[150]">
        <span id="toast-message"></span>
    </div>

    <div id="payment-modal"
        class="fixed inset-0 z-[100] flex items-center justify-center bg-black bg-opacity-60 hidden backdrop-blur-sm">
        <div class="relative bg-white rounded-2xl shadow-xl w-full max-w-md m-4 transform transition-all duration-300 ease-out scale-95 opacity-0"
            id="modal-content">
            <!-- Modal Header -->
            <div class="flex items-center justify-between p-4 border-b border-gray-200 rounded-t-2xl bg-gray-50">
                <h3 class="text-lg font-semibold text-gray-800">Pilih Metode Pembayaran</h3>
                <button id="close-modal-btn" class="text-gray-400 hover:text-gray-600 focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12">
                        </path>
                    </svg>
                </button>
            </div>

            <!-- Invoice Details -->
            <div class="p-4 bg-indigo-50 border-b border-gray-200">
                <p class="text-sm text-gray-600">Tagihan untuk:</p>
                <p id="modal-invoice-period" class="font-bold text-gray-800 text-lg"></p>
                <p id="modal-invoice-amount" class="font-semibold text-indigo-600 text-2xl"></p>
            </div>

            <!-- Modal Body -->
            <div class="p-6">
                <!-- Tabs -->
                <div class="flex border-b border-gray-200 mb-4">
                    <button id="qris-tab"
                        class="payment-tab active flex-1 py-2 text-center font-medium text-indigo-600 border-b-2 border-indigo-600">QRIS</button>
                    <button id="transfer-tab"
                        class="payment-tab flex-1 py-2 text-center font-medium text-gray-500">Transfer Manual</button>
                </div>

                <!-- Tab Content -->
                <div id="qris-content" class="payment-content">
                    <p class="text-center text-gray-600 mb-4 text-sm">Scan QR code di bawah ini menggunakan aplikasi
                        pembayaran favorit Anda.</p>
                    <div class="flex justify-center">
                        <img id="qris-image" src="assets/qris.jpeg" alt="QRIS Code"
                            class="w-auto h-auto max-w-xs max-h-80 object-contain rounded-lg shadow-md">
                    </div>
                    <p class="text-center text-xs text-gray-500 mt-4">QRIS ini statis. Pastikan jumlah transfer sesuai
                        dengan tagihan.</p>
                </div>

                <div id="transfer-content" class="payment-content hidden">
                    <div id="payment-methods-container" class="space-y-3">
                        <!-- Dynamic bank accounts will be inserted here -->
                    </div>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="px-6 py-4 bg-gray-50 rounded-b-2xl">
                <button id="confirm-payment-btn"
                    class="w-full flex items-center justify-center gap-2 bg-green-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-600 transition-colors duration-200">
                    <svg fill="#ffffff" width="24" height="24" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"
                        stroke="#ffffff">
                        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                        <g id="SVGRepo_iconCarrier">
                            <path
                                d="M11.42 9.49c-.19-.09-1.1-.54-1.27-.61s-.29-.09-.42.1-.48.6-.59.73-.21.14-.4 0a5.13 5.13 0 0 1-1.49-.92 5.25 5.25 0 0 1-1-1.29c-.11-.18 0-.28.08-.38s.18-.21.28-.32a1.39 1.39 0 0 0 .18-.31.38.38 0 0 0 0-.33c0-.09-.42-1-.58-1.37s-.3-.32-.41-.32h-.4a.72.72 0 0 0-.5.23 2.1 2.1 0 0 0-.65 1.55A3.59 3.59 0 0 0 5 8.2 8.32 8.32 0 0 0 8.19 11c.44.19.78.3 1.05.39a2.53 2.53 0 0 0 1.17.07 1.93 1.93 0 0 0 1.26-.88 1.67 1.67 0 0 0 .11-.88c-.05-.07-.17-.12-.36-.21z">
                            </path>
                            <path
                                d="M13.29 2.68A7.36 7.36 0 0 0 8 .5a7.44 7.44 0 0 0-6.41 11.15l-1 3.85 3.94-1a7.4 7.4 0 0 0 3.55.9H8a7.44 7.44 0 0 0 5.29-12.72zM8 14.12a6.12 6.12 0 0 1-3.15-.87l-.22-.13-2.34.61.62-2.28-.14-.23a6.18 6.18 0 0 1 9.6-7.65 6.12 6.12 0 0 1 1.81 4.37A6.19 6.19 0 0 1 8 14.12z">
                            </path>
                        </g>
                    </svg>
                    Konfirmasi via WhatsApp
                </button>
            </div>
        </div>
    </div>
</body>

</html>